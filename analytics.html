<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Analytics - Co-Sleep</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="sounds.js"></script>
    <script src="analytics.js"></script>
    <script src="preferences.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">Co-Sleep</div>
            <div class="header-right">
                <button class="back-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <div class="user-menu" id="user-menu" style="display: none;">
                    <button class="user-btn" onclick="toggleUserMenu()">
                        <i class="fas fa-user-circle"></i>
                        <span id="user-name">User</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <a href="#" onclick="showProfile()"><i class="fas fa-user"></i> Profile</a>
                        <a href="#" onclick="showPreferences()"><i class="fas fa-cog"></i> Preferences</a>
                        <a href="#" onclick="upgradePremium()"><i class="fas fa-crown"></i> Upgrade</a>
                        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container analytics-container">
        <!-- Analytics Header -->
        <div class="analytics-header">
            <h1><i class="fas fa-chart-line"></i> Sleep Analytics</h1>
            <p>Track your co-sleep patterns and improve your sleep quality</p>
        </div>

        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-icon">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="summary-content">
                    <h3>Total Sessions</h3>
                    <span id="total-sessions" class="summary-value">0</span>
                </div>
            </div>
            
            <div class="summary-card">
                <div class="summary-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="summary-content">
                    <h3>Total Duration</h3>
                    <span id="total-duration" class="summary-value">0m</span>
                </div>
            </div>
            
            <div class="summary-card">
                <div class="summary-icon">
                    <i class="fas fa-hourglass-half"></i>
                </div>
                <div class="summary-content">
                    <h3>Avg Duration</h3>
                    <span id="avg-duration" class="summary-value">0m</span>
                </div>
            </div>
            
            <div class="summary-card">
                <div class="summary-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="summary-content">
                    <h3>Avg Quality</h3>
                    <span id="avg-quality" class="summary-value">0.0 ⭐</span>
                </div>
            </div>
        </div>

        <!-- Analytics Sections -->
        <div class="analytics-sections">
            <!-- Weekly Stats -->
            <div class="analytics-section">
                <h2><i class="fas fa-calendar-week"></i> This Week</h2>
                <div class="stats-grid" id="weekly-stats">
                    <div class="stat-item">
                        <span class="stat-label">Sessions</span>
                        <span class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Duration</span>
                        <span class="stat-value">0m</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Avg Duration</span>
                        <span class="stat-value">0m</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Avg Quality</span>
                        <span class="stat-value">0.0 ⭐</span>
                    </div>
                </div>
            </div>

            <!-- Recent Sessions -->
            <div class="analytics-section">
                <h2><i class="fas fa-history"></i> Recent Sessions</h2>
                <div class="sessions-list" id="recent-sessions">
                    <p class="no-data">No sessions yet. Start your first co-sleep session!</p>
                </div>
            </div>

            <!-- Sleep Patterns -->
            <div class="analytics-section">
                <h2><i class="fas fa-chart-bar"></i> Sleep Patterns</h2>
                <div class="patterns-list" id="sleep-patterns">
                    <p class="no-data">No sleep patterns yet. Complete some sessions to see insights!</p>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="analytics-actions">
            <button class="action-btn" onclick="exportAnalytics()">
                <i class="fas fa-download"></i> Export Data
            </button>
            <button class="action-btn" onclick="clearAnalytics()">
                <i class="fas fa-trash"></i> Clear Data
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>Track your sleep journey • <a href="#" target="_blank">Privacy</a></p>
    </footer>

    <script>
        // Initialize analytics dashboard
        document.addEventListener('DOMContentLoaded', () => {
            if (window.analyticsManager) {
                window.analyticsManager.init();
            }
            if (window.preferencesManager) {
                window.preferencesManager.init();
            }
        });

        // Navigation functions
        function goBack() {
            window.location.href = 'index.html';
        }

        function toggleUserMenu() {
            const dropdown = document.getElementById('user-dropdown');
            dropdown.classList.toggle('show');
        }

        function showProfile() {
            alert('Profile feature coming soon!');
        }

        function showPreferences() {
            window.location.href = 'preferences.html';
        }

        function upgradePremium() {
            alert('Premium upgrade coming soon! This will include:\n• Advanced analytics\n• Sleep insights\n• Custom reports\n• Priority support');
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            window.location.href = 'index.html';
        }

        // Analytics functions
        function exportAnalytics() {
            if (window.analyticsManager) {
                const data = window.analyticsManager.exportAnalytics();
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `co-sleep-analytics-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        function clearAnalytics() {
            if (confirm('Are you sure you want to clear all analytics data? This action cannot be undone.')) {
                if (window.analyticsManager) {
                    window.analyticsManager.clearAnalytics();
                }
            }
        }
    </script>
</body>
</html> 