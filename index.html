<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Co-Sleep - Find Quiet Presence</title>
    
    <!-- Performance optimizations -->
    <meta name="description" content="Find quiet presence with Co-Sleep - A WebRTC-based co-sleeping app">
    <meta name="theme-color" content="#1a1a1a">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css?v=1.1" as="style">
    <link rel="preload" href="script.js?v=1.1" as="script">
    <link rel="preload" href="/socket.io/socket.io.js" as="script">
    
    <!-- Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css?v=1.1">
    
</head>
<body>
    <!-- Hero Section (Main Interface) -->
    <section class="hero-section" id="heroSection">
        <div class="hero-content">
            <div class="logo">ðŸŒ™</div>
            <h1>Hence</h1>
            <p class="tagline">Find quiet presence and peaceful sleep companionship</p>
            
            <!-- User Info Section -->
            <div id="user-info" class="user-info">
                Welcome, Anonymous
            </div>
            
            <button id="findPartnerBtn" class="primary-btn">
                Find Quiet Presence
            </button>
            
            <!-- Sound Controls -->
            <div class="sound-controls-section">
                <button id="soundCountBtn" class="sound-btn" aria-label="Background sounds">
                    ðŸŽµ Background Sounds
                </button>
            </div>
            
            <!-- Reset button for testing -->
            <button id="reset-onboarding" class="secondary-btn" style="margin-top: 1rem; font-size: 0.8rem; opacity: 0.7;">
                Reset Onboarding
            </button>
        </div>
        
        <div class="down-arrow">â†“</div>
    </section>

    <!-- Call Interface (Hidden by default) -->
    <div class="call-interface" id="callInterface" role="dialog" aria-labelledby="call-status" aria-hidden="true">
        <div class="call-header">
            <h2>Connected</h2>
            <p id="statusText">Connected</p>
        </div>
        <div class="call-controls">
            <button class="mute-btn" id="muteBtn" aria-label="Toggle mute">
                <span class="mute-icon" aria-hidden="true">ðŸŽ¤</span>
            </button>
            <button class="end-call-btn" id="endCallBtn" aria-label="End call">
                <span class="end-icon" aria-hidden="true">ðŸ“ž</span>
            </button>
        </div>
    </div>

    <!-- Loading Interface -->
    <div class="loading-interface" id="loadingInterface" role="status" aria-live="polite" aria-hidden="true">
        <div class="loading-content">
            <div class="loading-spinner" aria-hidden="true"></div>
            <p id="loadingText">Finding partner...</p>
            <button class="cancel-queue-btn" id="cancelQueueBtn" aria-label="Cancel finding partner">Cancel</button>
        </div>
    </div>

    <!-- Error Interface -->
    <div class="error-interface" id="errorInterface" role="alert" aria-live="assertive" aria-hidden="true">
        <div class="error-content">
            <h2>Connection Error</h2>
            <p id="errorText">Unable to connect. Please try again.</p>
            <button class="retry-btn" id="retryBtn">Retry</button>
        </div>
    </div>

    <!-- Preferences Overlay -->
    <div class="preferences-overlay" id="preferencesOverlay" role="dialog" aria-labelledby="preferences-title" aria-hidden="true">
        <div class="preferences-content">
            <div class="preferences-header">
                <h2 id="preferences-title">Preferences</h2>
                <button class="close-btn" id="closePreferencesBtn" aria-label="Close preferences">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="preferences-body">
                <!-- Preferences content will be loaded dynamically -->
                <p>Preferences coming soon...</p>
            </div>
        </div>
    </div>

    <!-- Sound Panel -->
    <div class="sound-panel" id="soundPanel" role="dialog" aria-labelledby="sound-title" aria-hidden="true">
        <div class="sound-content">
            <div class="sound-header">
                <h2 id="sound-title">Background Sounds</h2>
                <button class="close-btn" id="closeSoundBtn" aria-label="Close sound panel">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="sound-body">
                <div class="sound-controls">
                    <div class="global-volume-control">
                        <label for="globalVolume">Master Volume</label>
                        <input type="range" id="globalVolume" min="0" max="100" value="50" class="volume-slider">
                    </div>
                </div>
                <div id="soundList" class="sound-list">
                    <!-- Sounds will be populated by JavaScript -->
                </div>
                <div id="soundEmptyState" class="sound-empty-state" style="display: none;">
                    <p>No background sounds available</p>
                </div>
            </div>
        </div>
    </div>

    <!-- User Menu -->
    <div class="user-menu" id="userMenu" style="display: none;">
        <div class="user-info">
            <span id="userName">User</span>
        </div>
        <div class="user-dropdown" id="userDropdown">
            <button class="dropdown-item" onclick="showProfile()">Profile</button>
            <button class="dropdown-item" onclick="showAnalytics()">Analytics</button>
            <button class="dropdown-item" onclick="upgradePremium()">Upgrade</button>
            <button class="dropdown-item" onclick="logout()">Logout</button>
        </div>
    </div>

    <!-- Online Count -->
    <div class="online-count" id="onlineCount">
        <span class="count-label">Online:</span>
        <span class="count-value">0</span>
    </div>

    <!-- Login Button -->
    <button class="login-btn" id="loginBtn" style="display: none;">
        Login
    </button>

    <!-- Scripts with performance optimizations -->
    <script src="sounds.js?v=2.0" defer></script>
    <script src="preferences.js?v=1.1" defer></script>
    <script src="script.js?v=1.1" defer></script>
</body>
</html>
